{"ast":null,"code":"'use strict';\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar SCALAR_TYPES = ['number', 'integer', 'string', 'boolean', 'null'];\n\nmodule.exports = function defFunc(ajv) {\n  defFunc.definition = {\n    type: 'array',\n    compile: function compile(keys, parentSchema, it) {\n      var equal = it.util.equal;\n      var scalar = getScalarKeys(keys, parentSchema);\n      return function (data) {\n        if (data.length > 1) {\n          for (var k = 0; k < keys.length; k++) {\n            var i,\n                key = keys[k];\n\n            if (scalar[k]) {\n              var hash = {};\n\n              for (i = data.length; i--;) {\n                if (!data[i] || _typeof(data[i]) != 'object') continue;\n                var prop = data[i][key];\n                if (prop && _typeof(prop) == 'object') continue;\n                if (typeof prop == 'string') prop = '\"' + prop;\n                if (hash[prop]) return false;\n                hash[prop] = true;\n              }\n            } else {\n              for (i = data.length; i--;) {\n                if (!data[i] || _typeof(data[i]) != 'object') continue;\n\n                for (var j = i; j--;) {\n                  if (data[j] && _typeof(data[j]) == 'object' && equal(data[i][key], data[j][key])) return false;\n                }\n              }\n            }\n          }\n        }\n\n        return true;\n      };\n    },\n    metaSchema: {\n      type: 'array',\n      items: {\n        type: 'string'\n      }\n    }\n  };\n  ajv.addKeyword('uniqueItemProperties', defFunc.definition);\n  return ajv;\n};\n\nfunction getScalarKeys(keys, schema) {\n  return keys.map(function (key) {\n    var properties = schema.items && schema.items.properties;\n    var propType = properties && properties[key] && properties[key].type;\n    return Array.isArray(propType) ? propType.indexOf('object') < 0 && propType.indexOf('array') < 0 : SCALAR_TYPES.indexOf(propType) >= 0;\n  });\n}","map":null,"metadata":{},"sourceType":"module"}